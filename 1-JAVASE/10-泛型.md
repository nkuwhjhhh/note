# Part 10 泛型

类似于C++中的模板

> 所谓泛型，就是允许在定义类、接口时通过一个`标识`表示类中某个`属性的类型`或者是某个方法的`返回值或参数的类型`。这个类型参数将在使用时（例如，继承或实现这个接口、创建对象或调用方法时）确定（即传入实际的类型参数，也称为类型实参）。

不使用泛型时，在集合中可能出现的问题：

- 类型不安全
- 强转问题

**把一个集合中的内容限制为一个特定的数据类型，这就是generic背后的核心思想。**将不安全因素在编译期间排除，避免类型转换，同时，代码更加简洁健壮。

格式主要是尖括号里加类型

举例：比较器中使用泛型

```java
class CircleComparator1 implements Comparator<Circle> {

    @Override
    public int compare(Circle o1, Circle o2) {
        //不再需要强制类型转换，代码更简洁
        return Double.compare(o1.getRadius(), o2.getRadius());
    }
}
```

- 在创建集合对象的时候，可以指明泛型的类型。

  具体格式为：List<Integer> list = new ArrayList<Integer>();

- JDK7.0时，有新特性，可以简写为：

  List<Integer> list = new ArrayList<>(); //类型推断

- 泛型，也称为泛型参数，即参数的类型，只能使用引用数据类型进行赋值。（不能使用基本数据类型，可以使用包装类替换）

- 集合声明时，声明泛型参数。在使用集合时，可以具体指明泛型的类型。一旦指明，类或接口内部，凡是使用泛型参数的位置，都指定为具体的参数类型。如果没有指明的话，看做是Object类型。



### 3. 自定义泛型结构

#### 3.1 泛型的基础说明

1、<类型>这种语法形式就叫泛型。习惯上使用T表示

2、在哪里可以声明类型变量\<T>

- 泛型类，泛型接口

  ```java
  【修饰符】 class 类名<类型变量列表> 【extends 父类】 【implements 接口们】{
      
  }
  【修饰符】 interface 接口名<类型变量列表> 【implements 接口们】{
      
  }
  
  //例如：
  public class ArrayList<E>    
  public interface Map<K,V>{
      ....
  }    
  ```

- 泛型方法

  ```java
  [修饰符] <类型变量列表> 返回值类型 方法名([形参列表])[throws 异常列表]{
      //...
  }
  
  //例如：java.util.Arrays类中的
  public static <T> List<T> asList(T... a){
      ....
  }
  ```



#### 3.2 自定义泛型类或泛型接口

1. 声明完自定义泛型类以后，可以在类的内部（比如：属性、方法、构造器中）使用类的泛型。
2. 声明完自定义泛型类以后，若不指明类型，则默认Object。
3. 泛型的指定中必须使用引用数据类型。不能使用基本数据类型，此时只能使用包装类替换。
4. 泛型类的子类或泛型接口的实现类可以选择是否指定泛型参数，还可以新增泛型参数，还可以选择是否保留父类的泛型，或保留一部分。
5. 有多个参数则可以将多个参数一起放在尖括号中。
6. 异常类不能是带泛型的。
7. 不能使用new E[]。但是可以：E[] elements = (E[])new Object[capacity];
8. 在类/接口上声明的泛型，在本类或本接口中即代表某种类型，但不可以在静态方法中使用类的泛型，但可以由自己的泛型。



#### 3.3 自定义泛型方法

类、接口没有使用泛型参数，其方法可以单独定义。

- 泛型方法的格式：

```java
[访问权限]  <泛型>  返回值类型  方法名([泛型标识 参数名称])  [抛出的异常]{
    
}
```

- 方法，也可以被泛型化，与其所在的类是否是泛型类没有关系。
- 泛型方法中的泛型参数在方法被调用时确定。
- 泛型方法可以根据需要，声明为static的。



### 4. 泛型在继承上的体现

如果B是A的一个子类型（子类或者子接口），而G是具有泛型声明的类或接口，G<B>并不是G<A>的子类型！



### 5. 通配符的使用

#### 5.1 通配符的理解

使用类型通配符：？ 

比如：`List<?>`，`Map<?,?>`

​            `List<?>`是`List<String>`、`List<Object>`等各种泛型List的父类。



#### 5.2 通配符的读与写

只能读，不能写。唯一能写的是null。



#### 5.3 使用注意点

注意点1：编译错误：不能用在泛型方法声明上，返回值类型前面<>不能使用?

```java
public static <?> void test(ArrayList<?> list){
}
```

注意点2：编译错误：不能用在泛型类的声明上

```java
class GenericTypeClass<?>{
}
```

注意点3：编译错误：不能用在创建对象上，右边属于创建集合对象

```java
ArrayList<?> list2 = new ArrayList<?>();
```



#### 5.4 有限制的通配符

```java
<?>                    //允许所有泛型的引用调用

<? extends Number>     //指定上限，(无穷小 , Number]
//只允许泛型为Number及Number子类的引用调用

<? super Number>       //指定下限，[Number , 无穷大)
//只允许泛型为Number及Number父类的引用调用

<? extends Comparable>
//只允许泛型为实现Comparable接口的实现类的引用调用
```

